---
title: "Gleichberechtigung"
description: |
  Sind Filme Spiegel ihrer Gesellschaft?  
  Finde heraus, wie die Gleichberechtigung in Deinem Land aussieht und ob sie sich in der Filmwelt widerspiegelt!
output:
  distill::distill_article:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(usethis)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(scales)
library("openxlsx")
library(patchwork)

bechdel <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-09/movies.csv')
```

```{r, Bechdel Ranking - Datenvorbereitung}
# Trennung bei Länder-Kombinationen und Entfernung NAs
bechdel %>%
  separate_rows(country, sep = ", ") %>%
  group_by(country) %>%
  drop_na(country) -> bechdel2

# Anzahl Filme pro Land
bechdel2 %>%
  group_by(country) %>%
  count(country) -> bechdel_anzahlFilme
bechdel_anzahlFilme %>%
  rename("Anzahl" = "n") -> bechdel_anzahlFilme

# Anzahl Filme, die die Bechdel-Bewertung FAIL haben, pro Land
bechdel2 %>%
  group_by(country) %>%
  count(binary) %>%
  filter(binary == "FAIL") -> bechdel_fail
bechdel_fail %>%
  rename("AnzahlFails" = "n") -> bechdel_fail

# Zusammenfassung in einen Datensatz
merge(bechdel_fail, bechdel_anzahlFilme) -> bechdel_countriesFail

bechdel_countriesFail %>%
  mutate(ProzentFail = round((AnzahlFails/Anzahl*100), digits = 2)) %>% 
  filter(Anzahl > 11) -> bechdel_countriesFail
```


## Gleichberechtigung
Wir, die DataWizards, haben für Euch die spannendsten Länder bereitgestellt. Klick auf unsere Karte oder finde Dein Land über die Menüleiste, um Informationen rund ums Thema Gleichstellung zu finden: Sei es zum [Gleichstellungsindex](Glossar.html) oder zum [Bechdel-Test](Glossar.html).

```{r layout='l-body-outset', fig.width=8, fig.height=3}
# Diagramm zum Bechdel-Test
bechdel_countriesFail %>%
ggplot() +
  aes(x = ProzentFail, y = reorder(country, desc(ProzentFail)), xmin = 0, xmax = 100) +
  geom_col() +
  scale_x_continuous(limits = c(0, 100), 
                     breaks = c(0, 20, 40, 60,  80, 100)) +
  labs(x = "Bechdel-Test-Durchfallquote (in %)",
       y = NULL) +
  theme(axis.text=element_text(size=10)) -> plot_bechdel


equality <- read.xlsx(xlsxFile = "data/Equality_Index.xlsx", sheet = 2)

# Balkendiagramm zum Gleichstellungsindex
# in der Excel die Länder umbenennen: United Kingdoms zu UK & United States zu USA
countries <- c("New Zealand","Czech Republic", "Hong Kong", "China", "Italy", "Japan", "Ireland", "USA", "France", "Germany", "UK", "Canada", "Spain", "Australia")
equality %>%
  filter(Economy %in% countries) -> equality

equality %>%
ggplot() +
  aes(x = OVERALL.AVERAGE.SCORE, y = reorder(Economy, OVERALL.AVERAGE.SCORE), xmin = 0, xmax = 100) +
  geom_col() +
  scale_x_continuous(limits = c(0, 100), 
                     breaks = c(0, 20, 40, 60,  80, 100)) +
  labs(x = "Gleichstellungsindex (Gesamtpunktzahl)",
       y = NULL) +
  theme(axis.text=element_text(size=10)) -> plot_equality

plot_bechdel + plot_equality
```
- Korrelationstest?

```{r}
# Fails/Pass über die Jahre - Liniendiagramm
bechdel %>% 
  filter(country %in% countries) %>%
  count(year, binary) %>%
  ggplot() +
  aes(x = year, y =  n, color = binary) +
  geom_line()
  

```
- generelle Zunahme von Filmen über die Jahre
- wenige Peaks von mehr PASS als FAIL
- grundsätzlich werden trotz Zunahme immer mehr Filme produziert, die durchfallen
- zeigt, dass in der Filmbranche Gleichberechtigung nicht durchgesetzt ist
- Filme als Repräsentation/Spiegel der Gesellschaft
