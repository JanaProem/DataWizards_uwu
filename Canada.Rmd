---
title: "Kanada"
description: |
  Gleichstellungsindex (Gesamtpunktzahl): 94,5   
  50 der 97 produzierten Filme sind beim Bechdel-Test durchgefallen
output:
  distill::distill_article:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(usethis)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(scales)
library("openxlsx")
library(knitr)
library(unikn)

bechdel <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-09/movies.csv')
# Trennung bei Länder-Kombinationen und Entfernung NAs
bechdel %>%
  separate_rows(country, sep = ", ") %>%
  group_by(country) %>%
  drop_na(country) -> bechdel2

equality <- read.xlsx(xlsxFile = "data/Equality_Index.xlsx", 
                      sheet = 2)
```

## Ergebnisse beim Gleichstellungsindex
```{r, layout='1-page', fig.width=7, fig.height=3}
equality_long <- equality %>%
  filter(Economy == "Canada") %>%
  select(ends_with("score"))

# Umbenennung der Skalen
names(equality_long) <- c("Gleichstellungsindex (Gesamtpunktzahl)", "Zugang zu Behörden", "Grundstücknutzung", "Zugang zur Justiz", "Finanzieller Arbeitsanreiz", "Kreditwürdigkeit", "Zugang zu Arbeit", "Schutz vor Gewalt")
  
pivot_longer(equality_long,
            cols = everything(),
            names_to = "name", values_to = "score") -> equality_long
equality_long %>% mutate(ToHighlight = ifelse(name == "Gleichstellungsindex (Gesamtpunktzahl)", "ja", "nein")) -> equality_long

library(forcats)

equality_long %>%
  ggplot() +
    aes(y = fct_relevel(name, "Gleichstellungsindex (Gesamtpunktzahl)", 
                        "Zugang zur Justiz", "Zugang zu Behörden", 
                        "Zugang zu Arbeit", "Schutz vor Gewalt", 
                        "Kreditwürdigkeit", "Grundstücknutzung", 
                        "Finanzieller Arbeitsanreiz"), 
        x = score, 
        xmin = 0, xmax = 100,
        fill = ToHighlight) +
    geom_col() +
    labs(title = "Kanada", x = "Erreichte Punktzahl", y = "") +
    scale_x_continuous(breaks = c(0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100)) +
    scale_fill_manual(values = c("ja" = "#9370db", "nein" = "slategray1"), guide = "none")
```


### Hindernisse 


```{r panelset, layout='l-body', echo=FALSE}
xaringanExtra::use_panelset()

xaringanExtra::style_panelset_tabs(
  active_foreground = "#9370db",
  hover_foreground = "gray"
)
```

:::l-body

::::: {.panelset}

::: {.panel}
#### Finanzieller Arbeitsanreiz {.panel-name}
Nach dem Gleichstellungsindex vom CFR hat Kanada keine Hindernisse in diesem Bereich.
:::

::: {.panel}
#### Grundstücknutzung {.panel-name}
Nach dem Gleichstellungsindex vom CFR hat Kanada keine Hindernisse in diesem Bereich.
:::

::: {.panel}
#### Kreditwürdigkeit {.panel-name}
Nach dem Gleichstellungsindex vom CFR hat Kanada keine Hindernisse in diesem Bereich.
:::

::: {.panel}
#### Schutz vor Gewalt {.panel-name}
:::

::: {.panel}
#### Zugang zu Arbeit {.panel-name}
:::

::: {.panel}
#### Zugang zu Behörden {.panel-name}
Nach dem Gleichstellungsindex vom CFR hat Kanada keine Hindernisse in diesem Bereich.
:::

::: {.panel}
#### Zugang zur Justiz {.panel-name}
Nach dem Gleichstellungsindex vom CFR hat Kanada keine Hindernisse in diesem Bereich.
:::

:::::

:::


## Ergebnisse beim Bechdel-Test
## Allgemeine Situation der Gleichstellung
## Vergleich
## Fazit
